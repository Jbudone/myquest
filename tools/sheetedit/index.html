<html>
	<head>
		<title>Tilesheet Editor</title>

		<link rel="stylesheet" type="text/css" href="main.css">

		<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore.js"></script>
		<script src="scripts/main.js"></script>
		<script src="scripts/assets.js"></script>
		<script src="scripts/editor.js"></script>
		<script src="scripts/sheet.js"></script>

		<!-- Bootstrap -->
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
		<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

	</head>
	<body>

		<h1><a id="save" href="#">Tilesheet</a> Editor</h1>


		<div id="editArea" class="">
			<canvas id="sheet">

			</canvas>

			<div id="controls">
				<div id="buttons" class="">

					<div id="buttons_tilesheets" class="btn-group hidden">
						<button id="ctrl-objects" type="button" class="btn btn-default">Objects</button>
					</div>

					<div id="buttons_spritesheets" class="btn-group hidden">
						<button id="ctrl-avatar" type="button" class="btn btn-default">Avatar</button>
						<button id="ctrl-animation" type="button" class="btn btn-default">New Animation</button>
					</div>

					<div id="buttons_npcs" class="hidden">
					</div>
				</div>

				<div id="settings">


					<div id="settings_tilesheet" class="hidden">
						<div class="settings_component">
							<input type="text" id="tilesheet_id" class="form-control" placeholder="Tilesheet id" />
						</div>
						<div class="settings_component">
							<input type="range" id="tilesheet_tilesize" value="16" />
							<span class="form-label">Tilesize: </span><span class="form-label-value" id="tilesheet_tilesize_value">16</span>
							<input type="checkbox" id="tilesheet_showgrid" class="right" />
						</div>
						<div class="settings_component">
							<input type="number" id="tilesheet_sheet_offset_y" min="-256" max="256" value="0" />
							<span class="form-label">Offset Y </span>
							<br/>
							<input type="number" id="tilesheet_sheet_offset_x" min="-256" max="256" value="0" />
							<span class="form-label">Offset X </span>
						</div>

						<div class="objects_list">

						</div>
					</div>

					<div id="settings_spritesheet" class="hidden">
						<div class="settings_component">
							<input type="text" id="spritesheet_id" class="form-control" placeholder="Spritesheet id" />
						</div>
						<div class="settings_component">
							<input type="range" id="spritesheet_tilesize" />
							<span class="form-label">Tilesize: </span><span class="form-label-value" id="spritesheet_tilesize_value">16</span>
							<input type="checkbox" id="spritesheet_showgrid" class="right" />
						</div>
						<div class="settings_component">
							<input type="number" id="spritesheet_sheet_offset_y" min="-256" max="256" value="0" />
							<span class="form-label">Sheet Offset Y </span>
							<br/>
							<input type="number" id="spritesheet_sheet_offset_x" min="-256" max="256" value="0" />
							<span class="form-label">Sheet Offset X </span>
						</div>
						<div class="settings_component">
							<input type="number" id="spritesheet_sprite_offset_y" min="-256" max="256" value="0" />
							<span class="form-label">Sprite Offset Y </span>
							<br/>
							<input type="number" id="spritesheet_sprite_offset_x" min="-256" max="256" value="0" />
							<span class="form-label">Sprite Offset X </span>
						</div>
						<div class="settings_component">
							<input type="number" id="spritesheet_sprite_size_w" min="1" max="256" value="16" />
							<span class="form-label">Sprite Size (width)</span>
							<br/>
							<input type="number" id="spritesheet_sprite_size_h" min="1" max="256" value="16" />
							<span class="form-label">Sprite Size (height)</span>
						</div>
						<hr/>

						<div class="animation_list">
							<div class="animation_settings">

								<div class="animation_preview_area">
									<canvas id="animation_preview"></canvas>
								</div>

								<input type="text" id="animation_id" class="form-control" placeholder="Animation id" />
								<br/>
								<input type="number" id="animation_x" min="0" max="256" value="0" /> <span class="form-label">X Offset</span> <br/>
								<input type="number" id="animation_y" min="0" max="256" value="0" /> <span class="form-label">Y Offset</span> <br/>
								<input type="number" id="animation_w" min="0" max="256" value="0" /> <span class="form-label">Sprite Width</span> <br/>
								<input type="number" id="animation_h" min="0" max="256" value="0" /> <span class="form-label">Sprite Height</span> <br/>
								<input type="number" id="animation_l" min="0" max="256" value="0" /> <span class="form-label">Animation Length</span> <br/>
								<br/>
								<br/>
								<input type="checkbox" id="animation_flipX" />
								<span class="animation_setting_label">flipX</span>
							</div>
						</div>

					</div>

					<div id="settings_npcs" class="hidden">
						<div class="settings_component">
							<input type="text" id="npc_id" class="form-control" placeholder="NPC id" />
						</div>
						<div class="settings_component">
							<input type="text" id="npc_name" class="form-control" placeholder="NPC name" />
						</div>
						<div class="settings_component">
							<input type="number" id="npc_health" min="1" max="1000" value="10" />
							<span class="form-label">Health</span>
							<br/>
							<input type="number" id="npc_damage" min="1" max="100" value="5" />
							<span class="form-label">Damage</span>
							<br/>
							<input type="number" id="npc_speed" min="1" max="100" value="12" />
							<span class="form-label">Speed</span>
							<br/>
							<input type="number" id="npc_spawn" min="1" max="60000" value="8000" />
							<span class="form-label">Respawn Time</span>
						</div>
					</div>

				</div>
			</div>
		</div>



		<div id="assetsArea">
			<div id="assets">

			</div>

			<a id="assetsSave" href="">
				SAVE
			</a>

			<div id="assetsControls">
				<a id="addTilesheet" class="assetButton" href="">Add Tilesheet</a>
				<a id="addSpritesheet" class="assetButton" href="">Add Spritesheet</a>
				<a id="addNPC" class="assetButton" href="">Add NPC</a>
			</div>
		</div>
		
		
		<!--
			TODO
				> editor.js: load/switch/save npc; add npc; remove npc; unload
				> assets
					* resources: { Sheets: ..., NPCs: ..., ... }; keep track of which resources have changed
					* save each modified resource to their appropriate files
					* load resources.json initially
					* load each resource from specified files

					resources.json
						Sheets: sheets.json
						NPC's: npcs.json
						Items: items.json
						Scripts: scripts.json
					sheets.json
						Tilesheets, Spritesheets
					npcs.json
						NPCs
					items.json
					scripts.json
					avatars.json
						{
							image: {
								file: "img.png",
								size: 16
							},
							avatars: {
								"firefox": 0,
								"goblin": 1
							}
						}


				> Game Changes: assets.json; tilesPerRow/columns; sprite_offset/sheet_offset; tilesize.xy

				> tile highlight w/ sheet offset
				> sprite preview (for offset, animation, etc.)
				> tilesize: x/y
				> write JSON in prettify'd format; and unprettified for .min
				> Animations: sheet editor shows transparent grid when modifying the width/height and x/y offset for the animation, and allows mouse selection for adding/removing sprites in the animation; animation width/height and x/y offset inherited from base image (base image fetches its tile width/height and x/y offset from avg values from animation set)
					Animation: { name, x, y, w, h, l, flipX }
				> Animation preview (works with sprite width/height)
					- Begin with Avatar preview (when no animation selected)
					- flipX
				> Materials? (differing spritesheets w/ same sprites; how to share animation sets between them)

				> Create Animation object (new Animation(x, y, ..))
				> Compress tilesheets: if tilesheet has same w/h for all tiles, then keep w/h in tilesheet and use tx/ty for tiles
				> Load asset into memory (decompress), modify stuff in memory, then save all changes
				> In-game width/height for sprite



				> BUG: new spritesheet -> new animation
				> BUG: new spritesheet -> *drop image* -> new animation
					- FIX: draw border around the canvas to indicate that the user must drop an image next; then draw border around spritesheet name to indicate user must do that next; then draw border around save to indicate user must do that next
				> BUG: click a tilesheet w/ objects; click another tilesheet w/ no objects (see they remain); click tilesheet w/ objects again (see they stack)


				> don't allow saving unless all required fields are filled
				> main.js: prompt before leavePage (unsaved changes)
				> sprite states
				> show which tilesheet/spritesheet/npc is currently being edited
				> display selected animation (animating)
		-->
	</body>
</html>
